<!DOCTYPE html>
<html>
<head>
	<title>Ping Pong Game</title>
</head>
<body>
	<canvas id="canvas" width="800" height="400" style="border: solid black;"></canvas>
	<script type="text/javascript" src="js/app.js"></script>
	<script type="text/javascript" src="js/playersCommands.js"></script>
	<script type="text/javascript" src="js/startBall.js"></script>
	<script type="text/javascript">
		//Sample functions, remove these functions and design ping-pong game with onInit and onUpdate.

		app.onInit = function(){

			/*Values*/
			const canvasTotalWidth = this.canvas.width
			const canvasTotalHeight = this.canvas.height
			const paddleInitialPosition = this.canvas.height/2 - 150/2

			this.nodes.push({
				id : 'red-box',
				x  : startBallPositionAxisX(canvasTotalWidth),
				y  : startBallPositionAxisY(canvasTotalHeight),
				width  : 100,
				height : 100,
				color  : 'red',
				directionX : 3,
				directionY : -3
			});

			this.nodes.push({
				id : 'player-one',
				x  : 0,
				y  : paddleInitialPosition,
				width  : 50,
				height : 150,
				color  : 'black'
			});

			this.nodes.push({
				id : 'player-two',
				x  : canvasTotalWidth - 50,
				y  : paddleInitialPosition,
				width  : 50,
				height : 150,
				color  : 'blue'
			});

			playersMoves = playersMoves.bind(this)
			document.addEventListener('keydown', playersMoves)
		};
		
		app.onUpdate = function(time){

			if(this.getNode("player-one").y < 0){
				this.getNode("player-one").y = 0
			}

			if(this.getNode("player-one").y >= 250){
				this.getNode("player-one").y = 250
			}

			if(this.getNode("player-two").y < 0){
				this.getNode("player-two").y = 0
			}

			if(this.getNode("player-two").y >= 250){
				this.getNode("player-two").y = 250
			}

			/*Ball bouncing logic*/
			this.getNode('red-box').x += this.getNode('red-box').directionX;
			this.getNode('red-box').y += this.getNode('red-box').directionY;
			
			let player = this.getNode('red-box').x < this.canvas.width / 2 
			? collision(this.getNode('red-box'), this.getNode('player-one'))
			: collision(this.getNode('red-box'), this.getNode('player-two'))

			if(this.getNode('red-box').y + this.getNode('red-box').height > this.canvas.height || this.getNode('red-box').y < 0){
				this.getNode('red-box').directionY = -this.getNode('red-box').directionY;
				console.log("Changed: directionY in: ", this.getNode('red-box').y);
			}

			if(this.getNode('red-box').x + this.getNode('red-box').width > this.canvas.width || this.getNode('red-box').x < 0){
				this.getNode('red-box').directionX = -this.getNode('red-box').directionX;
				console.log("Changed: directionY in: ", this.getNode('red-box').y);
			}
		};
	</script>
</body>
</html>