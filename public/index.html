<!DOCTYPE html>
<html>
<head>
	<style>
	/* Make canvas full size */
	canvas {
	    position:fixed;
	    left:0;
	    top:0;
	    width:100%;
	    height:100%;
	}
	</style>
	<title>Ping Pong Game</title>
</head>
<body>
	<canvas id="canvas" width="800" height="400"></canvas>
	<script type="text/javascript" src="js/app.js"></script>
	<script type="text/javascript">
		//Sample functions, remove these functions and design ping-pong game with onInit and onUpdate.

		app.onInit = function(){
			this.nodes.push({
				id : 'keypress',
				w  : false,
				s  : false,
				uparrow  : false,
				downarrow : false,
				space : false
			});

			this.nodes.push({
				id : 'red-box',
				x  : 0,
				y  : 0,
				width  : 50,
				height : 100,
				color  : 'red',
				direction : 0
			});

			this.nodes.push({
				id : 'black-box',
				x  : 750,
				y  : 0,
				width  : 50,
				height : 100,
				color  : 'black'
			});

			this.nodes.push({
				id : 'ball',
				x  : canvas.width/2-50,
				y  : canvas.height/2-25,
				width  : 100,
				height : 50,
				velocityX: (3*rand_1_or_neg1()),
				velocityY: (3*rand_1_or_neg1()),
				color  : 'green'
			})


		};

		//random number between 1 and negative 1
		function rand_1_or_neg1()
		{
			var rand = (Math.floor(Math.random() * 2)+1)
			if (rand == 2)
				rand = -1
			if (rand == 1)
				rand = 1
			console.log(rand)
			return(rand)
		}


			document.addEventListener("keydown", (e) =>
		{
			if (e.key == "w")
			{
				app.getNode('keypress').w = true;
			}
			if (e.key == "s")
			{
				app.getNode('keypress').s = true;
			}

			if (e.key == "ArrowUp")
			{
				app.getNode('keypress').uparrow = true;
			}
			if (e.key == "ArrowDown")
			{
				app.getNode('keypress').downarrow = true;
			}
		})
		document.addEventListener("keyup", (e) =>
		{
			if (e.key == "w")
			{
				app.getNode('keypress').w = false;
			}
			if (e.key == "s")
			{
				app.getNode('keypress').s = false;
			}
			if (e.key == "ArrowUp")
			{
				app.getNode('keypress').uparrow = false;
			}
			if (e.key == "ArrowDown")
			{
				app.getNode('keypress').downarrow = false;
			}
		})

		function moveBall()
		{
						//Move ball
						app.getNode('ball').x += app.getNode('ball').velocityX
						app.getNode('ball').y += app.getNode('ball').velocityY
						//reverse direction
						if (app.getNode('ball').y >= (canvas.height-app.getNode('ball').height) || app.getNode('ball').y <= 0)
						{
							app.getNode('ball').velocityY  = app.getNode('ball').velocityY * -1
						}
		}
		function movePlayer()
		{
				if (app.getNode('keypress').w == true)
					app.getNode('black-box').y--
				if (app.getNode('keypress').s == true)
					app.getNode('black-box').y++

				if (app.getNode('keypress').uparrow == true)
					app.getNode('red-box').y--
				if (app.getNode('keypress').downarrow == true)
					app.getNode('red-box').y++
		}

		app.onUpdate = function(time){

		moveBall()
		movePlayer()
			//Random direction by velocity (x/y * -1) randomly



			/*
			this.getNode('black-box').y++;

			if(Math.cos(this.timestamp / 100) > 0){
				this.getNode('red-box').direction = -1;
			}else{
				this.getNode('red-box').direction = 1;
			}
			this.getNode('red-box').x+=this.getNode('red-box').direction;
		*/

		};
	</script>
</body>
</html>
